# Получение Figma Personal Access Token

## Пошаговая инструкция с визуальными подсказками

---

## Шаг 1: Открыть Figma Settings

### Вариант A: Через веб-интерфейс

1. Открыть https://www.figma.com/ в браузере
2. Войти в аккаунт (если не залогинены)
3. Нажать на **аватар** (правый верхний угол)
4. Выбрать **"Settings"** из меню

### Вариант B: Прямая ссылка

Просто открыть:
```
https://www.figma.com/settings
```

---

## Шаг 2: Перейти в Account

В левом меню Settings найти и нажать:
```
Account
```

Это вторая опция сверху (после Profile).

---

## Шаг 3: Найти Personal access tokens

1. Прокрутить страницу **вниз**
2. Найти секцию **"Personal access tokens"**
3. Под ней будет описание: *"Tokens you have generated that can be used to access the Figma API"*

---

## Шаг 4: Создать новый токен

1. Нажать кнопку **"Create a new personal access token"** (или "Generate new token")

2. Появится окно **"Create a new personal access token"**

3. В поле **"Token description"** ввести название (например):
   ```
   Claude Code Integration
   ```
   Или:
   ```
   API Access for Automation
   ```

4. **(Опционально)** Выбрать **Expiration**:
   - **No expiration** - токен не истекает (рекомендуется для разработки)
   - **30 days** - истечёт через 30 дней
   - **60 days** - истечёт через 60 дней
   - **90 days** - истечёт через 90 дней
   - **Custom** - указать свою дату

5. **(Опционально)** Выбрать **Scopes** (разрешения):
   - **File content** - чтение файлов (обязательно!)
   - **File comments** - чтение комментариев
   - **Webhooks** - создание webhooks

   **Для базового использования достаточно:** ✓ File content

6. Нажать **"Generate token"**

---

## Шаг 5: Скопировать токен

### ⚠️ КРИТИЧЕСКИ ВАЖНО!

После генерации появится окно с токеном:

```
Your personal access token

figd_1234567890abcdefghijklmnopqrstuvwxyz...

This is the only time you'll see this token.
Make sure to copy it now!
```

**Действия:**

1. ✅ Нажать кнопку **"Copy token"** (или выделить и Ctrl+C)

2. ✅ **Сохранить в безопасное место** (например, password manager)

3. ⚠️ **НЕ ЗАКРЫВАТЬ окно** пока не убедитесь что токен скопирован!

4. ⚠️ **Токен показывается ОДИН РАЗ** - если закроете, придётся создавать новый

---

## Шаг 6: Формат токена

Токен выглядит примерно так:
```
figd_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

Начинается с `figd_` и длина ~50-70 символов.

---

## Шаг 7: Добавить токен в .env

1. Открыть файл `.env` в корне проекта:
   ```
   CloudeCode\.env
   ```

2. Найти строку:
   ```bash
   FIGMA_API_TOKEN=your_figma_token_here
   ```

3. Заменить `your_figma_token_here` на скопированный токен:
   ```bash
   FIGMA_API_TOKEN=figd_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   ```

4. Сохранить файл (Ctrl+S)

---

## Шаг 8: Проверить токен

### Запустить тестовый скрипт:

```bash
# Из корня проекта
Scripts\test_figma_connection.bat
```

Или:
```bash
cd Scripts
python figma_connect.py
```

### Ожидаемый результат:

```
============================================================
Проверка подключения к Figma API
============================================================

1. Информация о файле:
✓ Файл: NEXR-STORE3-Red
✓ Последнее изменение: ...
✓ Версия: ...

============================================================
✓ Подключение работает!
============================================================
```

---

## Troubleshooting

### ❌ 403 Forbidden

**Причина:** Неправильный токен или истёк срок действия

**Решение:**
1. Проверить что токен скопирован полностью (без пробелов)
2. Проверить что токен в `.env` начинается с `figd_`
3. Если токен старый - создать новый

---

### ❌ 404 Not Found

**Причина:** Файл не найден или нет доступа

**Решение:**
1. Проверить что у вас есть доступ к файлу (минимум Viewer)
2. Проверить что file_key правильный (из URL)
3. Попробовать другой файл

---

### ❌ Token не сохранился в .env

**Причина:** Возможно файл открыт в другом редакторе

**Решение:**
1. Закрыть все редакторы
2. Открыть `.env` в notepad/VS Code
3. Убедиться что нет кавычек вокруг токена:
   ```bash
   # ПРАВИЛЬНО
   FIGMA_API_TOKEN=figd_xxxx

   # НЕПРАВИЛЬНО
   FIGMA_API_TOKEN="figd_xxxx"
   FIGMA_API_TOKEN='figd_xxxx'
   ```

---

## Безопасность токена

### ✅ Делать:
- Хранить в `.env` файле (уже в `.gitignore`)
- Использовать password manager для backup
- Создавать токены с минимальными необходимыми правами
- Устанавливать expiration date для production токенов

### ❌ НЕ делать:
- Коммитить в Git
- Отправлять в публичные репозитории
- Показывать в скриншотах/видео
- Отправлять по email/мессенджерам

---

## Управление токенами

### Просмотр активных токенов:

```
Figma → Settings → Account → Personal access tokens
```

Здесь видны:
- Все созданные токены
- Описание каждого токена
- Дата последнего использования
- Дата создания

### Удаление токена:

1. Найти токен в списке
2. Нажать **"Delete"** справа
3. Подтвердить удаление

**Когда удалять:**
- Токен скомпрометирован
- Больше не используется
- Истёк срок действия

### Ротация токенов:

**Для production:**
1. Создать новый токен
2. Обновить в `.env`
3. Проверить что всё работает
4. Удалить старый токен

---

## Пример: Полный flow

### 1. Создание
```
Figma → Settings → Account → Personal access tokens
→ "Create a new personal access token"
→ Description: "Claude Code API"
→ Scopes: ✓ File content
→ Expiration: No expiration
→ Generate token
```

### 2. Копирование
```
figd_abcdefghijklmnopqrstuvwxyz1234567890 [Copy token]
```

### 3. Сохранение в .env
```bash
# Открыть .env
code .env

# Найти и заменить
FIGMA_API_TOKEN=figd_abcdefghijklmnopqrstuvwxyz1234567890

# Сохранить
Ctrl+S
```

### 4. Проверка
```bash
Scripts\test_figma_connection.bat

# Ожидаемо:
✓ Подключение работает!
```

---

## FAQ

### Q: Сколько токенов можно создать?
**A:** Unlimited (без ограничений), но рекомендуется создавать по одному на каждое приложение/сервис.

### Q: Можно ли восстановить токен если потерял?
**A:** Нет. Нужно создать новый токен и заменить в приложениях.

### Q: Отличается ли токен от OAuth?
**A:** Да. Personal Access Token для API, OAuth для интерактивного доступа (Claude Code MCP использует OAuth).

### Q: Можно ли использовать один токен для всех проектов?
**A:** Можно, но не рекомендуется для security. Лучше создать отдельные токены для разных целей.

---

**Готово!** После этих шагов ваш Figma API токен будет готов к использованию.
