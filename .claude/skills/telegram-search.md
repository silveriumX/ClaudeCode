# Telegram Search

> Поиск по Telegram-каналам через TGStat API или Exa MCP.
> Два режима: поиск по всему Telegram (TGStat) или по проиндексированным каналам (Exa).

---

## Когда использовать

- "Что пишут в Telegram о X?"
- "Найди посты в Telegram-каналах по теме Y"
- "Какие каналы освещают тему Z?"
- "Есть ли обсуждение этого в русскоязычных Telegram-каналах?"
- "/telegram-search"

---

## Два режима работы

### Режим A: Exa MCP (без API ключей, сразу)

Exa индексирует часть публичных Telegram-каналов через t.me. Покрытие ограничено, но доступно сразу.

```
mcp__exa__web_search_exa(
  query="[тема] site:t.me",
  livecrawl="preferred"
)

# Или через domain filter
mcp__exa__web_search_exa(
  query="[тема]",
  include_domains=["t.me"]
)
```

**Ограничения режима A:**
- Покрытие ~10-20% публичных каналов (те, что Exa успела проиндексировать)
- Нет поиска по закрытым/приватным каналам
- Хорошо работает для англоязычного контента, хуже для русского

---

### Режим B: TGStat API (если есть API ключ, $25/мес)

TGStat индексирует 2.5+ млн каналов включая русскоязычные. Это полноценный поиск по Telegram.

**Конфигурация:**
```
.env:
TGSTAT_TOKEN=ваш_ключ  # api.tgstat.ru
```

**Поиск постов по ключевому слову:**
```
GET https://api.tgstat.ru/posts/search
Параметры:
  token: TGSTAT_TOKEN
  q: "ключевое слово"
  limit: 50
  startDate: [unix timestamp]
  endDate: [unix timestamp]

Ответ: список постов с текстом, каналом, датой, просмотрами
```

**Поиск каналов по теме:**
```
GET https://api.tgstat.ru/channels/search
Параметры:
  token: TGSTAT_TOKEN
  q: "тема"
  limit: 20
  language: "ru"  # или "en"

Ответ: каналы с описанием, количеством подписчиков, категорией
```

**Упоминания конкретного канала:**
```
GET https://api.tgstat.ru/channels/{channelId}/mentions
Параметры:
  token: TGSTAT_TOKEN

Ответ: какие каналы упоминают данный канал
```

---

## Алгоритм выполнения

### Если есть TGStat API:

1. Поиск постов по ключевому слову (`/posts/search`)
2. Поиск каналов по теме (`/channels/search`)
3. Сортировка постов по просмотрам (relevance × reach)
4. Синтез отчёта

### Если только Exa MCP:

1. `mcp__exa__web_search_exa` с `include_domains=["t.me"]`
2. Дополнительно: WebFetch на конкретные публичные каналы если известны
3. Честно указать в отчёте что охват ограничен

---

## Формат отчёта

```markdown
## Telegram: [тема] — [период]

**Источник:** TGStat API / Exa MCP (указать)
**Охват:** [N каналов / частичный]

### Топ каналы по теме
- [@channel](t.me/channel) — [N подписчиков], [описание]

### Ключевые посты
- [текст поста](URL) — [канал] — [N просмотров]

### Сентимент
- [позитив / негатив / нейтраль]

### Языковой разрез
- RU: [что в русскоязычных каналах]
- EN: [что в англоязычных]

### Ограничения
[Что не удалось найти и почему]
```

---

## Получение TGStat API ключа

1. Зарегистрироваться на api.tgstat.ru
2. Выбрать план: Free (5 каналов, 1000 запросов/мес) или S ($25/мес)
3. Добавить токен в `.env`: `TGSTAT_TOKEN=...`
4. Добавить в CLAUDE.md в секцию "Preferred Stack"

---

## Для real-time мониторинга

Exa и TGStat дают **исторические данные**. Для real-time alerts:
- **TeleSnipe** (telesnipe.com) — бесплатная бета, keyword alerts из Telegram
- **Telemetr.io "Spy"** — платно, но лучшее качество
- **streaming_overseer** (GitHub) — self-hosted, Telethon-based (нужен отдельный аккаунт)

---

## Связанные скиллы

- `/reddit-search` — Reddit через Exa
- `/social-research` — комплексный поиск по всем платформам
- `/monitor-pipeline` — автоматический мониторинг с алертами
