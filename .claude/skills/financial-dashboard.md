# Financial Dashboard

> Dashboard –≤ Google Sheets: P&L, Cash Flow, —Ä–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.
> –°—Ç—Ä–æ–∏—Ç—Å—è –ø–æ–≤–µ—Ä—Ö –µ–¥–∏–Ω–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (financial-journal-schema).

---

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- –°–æ–∑–¥–∞—ë—à—å –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞
- –î–æ–±–∞–≤–ª—è–µ—à—å –Ω–æ–≤—ã–π –ª–∏—Å—Ç —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—à—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π P&L –∏–ª–∏ Cash Flow

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ dashboard

```
–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∂—É—Ä–Ω–∞–ª (Google Spreadsheet)
‚îÇ
‚îú‚îÄ‚îÄ ... (—Å–ø—Ä–∞–≤–æ—á–Ω—ã–µ –ª–∏—Å—Ç—ã)
‚îÇ
‚îú‚îÄ‚îÄ üìä P&L           ‚Üê –î–æ—Ö–æ–¥—ã - –†–∞—Å—Ö–æ–¥—ã = –ü—Ä–∏–±—ã–ª—å –ø–æ –º–µ—Å—è—Ü–∞–º
‚îú‚îÄ‚îÄ üí∞ Cash Flow     ‚Üê –†–µ–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Å—á—ë—Ç—É
‚îú‚îÄ‚îÄ ü•ß –†–∞—Å—Ö–æ–¥—ã       ‚Üê –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ (–¥–ª—è –ø–æ–∏—Å–∫–∞ –¥—ã—Ä)
‚îî‚îÄ‚îÄ üî¢ –ò—Ç–æ–≥–æ         ‚Üê –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∫–ª—é—á–µ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
```

---

## –õ–∏—Å—Ç "P&L" (Profit & Loss)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
      | A         | B       | C       | D       | ... | M       | N
  1   | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | 2025-01 | 2025-02 | 2025-03 | ... | 2025-12 | –ò–¢–û–ì–û
  2   | –î–û–•–û–î–´    |         |         |         |     |         |
  3   | –í—ã—Ä—É—á–∫–∞   | formula | formula | formula | ... | formula | =SUM(B3:M3)
  4   | –ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã |      |         |         |     |         |
  5   | ‚îÄ‚îÄ –ò—Ç–æ–≥–æ –¥–æ—Ö–æ–¥–æ–≤ ‚îÄ‚îÄ | =SUM(B3:B4) | ...  |     |
  6   |           |         |         |         |     |         |
  7   | –†–ê–°–•–û–î–´   |         |         |         |     |         |
  8   | –ù–∞–ª–æ–≥–∏    | formula | formula | ...
  9   | –ó–∞—Ä–ø–ª–∞—Ç–∞  | formula | ...
  10  | –ü–æ–¥—Ä—è–¥—á–∏–∫–∏|
  11  | –ê—Ä–µ–Ω–¥–∞    |
  12  | –ó–∞–∫—É–ø–∫–∏   |
  13  | –õ–æ–≥–∏—Å—Ç–∏–∫–∞ |
  14  | –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ |
  15  | –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
  16  | IT –∏ —Å–µ—Ä–≤–∏—Å—ã |
  17  | –û—Ñ–∏—Å      |
  18  | –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–¥—ã |
  19  | ‚îÄ‚îÄ –ò—Ç–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–æ–≤ ‚îÄ‚îÄ |
  20  |           |
  21  | –ü–†–ò–ë–´–õ–¨   | =B5-B19 | =C5-C19 | ...    ‚Üê –ö–ª—é—á–µ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
```

### –§–æ—Ä–º—É–ª—ã –¥–ª—è —è—á–µ–µ–∫

```
# –í—ã—Ä—É—á–∫–∞ –∑–∞ –º–µ—Å—è—Ü (—è—á–µ–π–∫–∞ B3, –º–µ—Å—è—Ü "2025-01" –≤ B1)
=SUMPRODUCT(
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$F$2:$F$10000="IN") *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$L$2:$L$10000="–í—ã—Ä—É—á–∫–∞") *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$Q$2:$Q$10000=B$1) *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$N$2:$N$10000=FALSE) *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$G$2:$G$10000)
)

# –†–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞ –º–µ—Å—è—Ü (—è—á–µ–π–∫–∞ B8 ‚Äî –ù–∞–ª–æ–≥–∏)
=SUMPRODUCT(
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$F$2:$F$10000="OUT") *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$L$2:$L$10000=$A8) *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$Q$2:$Q$10000=B$1) *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$N$2:$N$10000=FALSE) *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$G$2:$G$10000)
)

# –ü—Ä–∏–±—ã–ª—å (—É—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –∑–µ–ª—ë–Ω—ã–π > 0, –∫—Ä–∞—Å–Ω—ã–π < 0)
=B5-B19
```

### –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
# –°—Ç—Ä–æ–∫–∞ –ü–†–ò–ë–´–õ–¨ ‚Äî —Ü–≤–µ—Ç –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é
def apply_conditional_formatting(worksheet, row_number: int):
    """
    –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∑–µ–ª—ë–Ω—ã–π/–∫—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –∫ —Å—Ç—Ä–æ–∫–µ –ø—Ä–∏–±—ã–ª–∏.
    –ò—Å–ø–æ–ª—å–∑—É–π gspread_formatting –∏–ª–∏ Google Sheets API.
    """
    # –ó–µ–ª—ë–Ω—ã–π –µ—Å–ª–∏ > 0
    # –ö—Ä–∞—Å–Ω—ã–π –µ—Å–ª–∏ < 0
    # –ñ—ë–ª—Ç—ã–π –µ—Å–ª–∏ = 0
```

---

## –õ–∏—Å—Ç "Cash Flow"

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚Äî –æ—Å—Ç–∞—Ç–∫–∏ —Å—á–µ—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```
  | A                        | B          | C
1 | –°—á—ë—Ç                     | –û—Å—Ç–∞—Ç–æ–∫    | –ü–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é –Ω–∞
2 | –ò–ü –ü–∏—Ä–æ–∂–∫–æ–≤–∞ ‚Äî –ú–æ–¥—É–ª—å–±–∞–Ω–∫ 40802...   | formula    | formula
3 | –û–û–û X ‚Äî –°–±–µ—Ä–±–∞–Ω–∫ 40702...            | formula    | formula
4 |                           |            |
5 | –ò–¢–û–ì–û                    | =SUM(B2:B4)| =TODAY()
```

### –§–æ—Ä–º—É–ª–∞ –æ—Å—Ç–∞—Ç–∫–∞ –ø–æ —Å—á—ë—Ç—É

```
# –û—Å—Ç–∞—Ç–æ–∫ = –ù–∞—á–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ + –í—Å–µ –ø—Ä–∏—Ö–æ–¥—ã - –í—Å–µ —Ä–∞—Å—Ö–æ–¥—ã
# –î–ª—è —Å—á—ë—Ç–∞ 40802810570010435344:

=SUMPRODUCT(
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$E$2:$E$10000="40802810570010435344") *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$F$2:$F$10000="IN") *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$G$2:$G$10000)
)
-
SUMPRODUCT(
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$E$2:$E$10000="40802810570010435344") *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$F$2:$F$10000="OUT") *
  ('–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'!$G$2:$G$10000)
)
+ [–Ω–∞—á–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ –∏–∑ –ª–∏—Å—Ç–∞ –°—á–µ—Ç–∞]
```

**–í–ê–ñ–ù–û:** –û—Å—Ç–∞—Ç–æ–∫ –ø–æ –∂—É—Ä–Ω–∞–ª—É = –æ—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤—ã–ø–∏—Å–∫–∏, –ù–ï —Ä–µ–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ —Å–µ–π—á–∞—Å. –ù—É–∂–Ω–æ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –≤—ã–ø–∏—Å–∫–∏.

---

## –õ–∏—Å—Ç "–†–∞—Å—Ö–æ–¥—ã" (–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑)

### –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∑–∞ –º–µ—Å—è—Ü

```
           | –Ø–Ω–≤  | –§–µ–≤  | –ú–∞—Ä  | ...  | –ò–¢–û–ì–û | %
–ù–∞–ª–æ–≥–∏     | 427–ö | 655–ö | 427–ö |      |       | 15%
–ó–∞—Ä–ø–ª–∞—Ç–∞   | 350–ö | 350–ö | 380–ö |      |       | 12%
–ó–∞–∫—É–ø–∫–∏    | 2.4–ú | 2.7–ú | 1.5–ú |      |       | 48%
–õ–æ–≥–∏—Å—Ç–∏–∫–∞  | 180–ö | 210–ö | 195–ö |      |       | 7%
–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥  | 85–ö  | 90–ö  | 75–ö  |      |       | 3%
–ê—Ä–µ–Ω–¥–∞     | 120–ö | 120–ö | 120–ö |      |       | 4%
...
–ò–¢–û–ì–û      | ....
```

–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞: –ö—Ä–∞—Å–Ω—ã–π (–≤—ã—Å–æ–∫–∏–π) ‚Üí –ñ—ë–ª—Ç—ã–π ‚Üí –ó–µ–ª—ë–Ω—ã–π (–Ω–∏–∑–∫–∏–π).

---

## –õ–∏—Å—Ç "–ò—Ç–æ–≥–æ" (–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞)

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  –§–ò–ù–ê–ù–°–û–í–´–ô –î–ê–®–ë–û–†–î                  ‚ïë
‚ïë  –û–±–Ω–æ–≤–ª–µ–Ω–æ: [–¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–º–ø–æ—Ä—Ç–∞]‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  –≠–¢–û–¢ –ú–ï–°–Ø–¶ (—Ñ–µ–≤—Ä–∞–ª—å 2026)           ‚ïë
‚ïë  üì• –í—ã—Ä—É—á–∫–∞:    X,XXX,XXX ‚ÇΩ          ‚ïë
‚ïë  üì§ –†–∞—Å—Ö–æ–¥—ã:    X,XXX,XXX ‚ÇΩ          ‚ïë
‚ïë  üìà –ü—Ä–∏–±—ã–ª—å:    X,XXX,XXX ‚ÇΩ   üü¢/üî¥  ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  –ë–ê–õ–ê–ù–°–´ –°–ß–ï–¢–û–í                      ‚ïë
‚ïë  –ú–æ–¥—É–ª—å–±–∞–Ω–∫:    X,XXX,XXX ‚ÇΩ          ‚ïë
‚ïë  –°–±–µ—Ä–±–∞–Ω–∫:      X,XXX,XXX ‚ÇΩ          ‚ïë
‚ïë  –¢-–ë–∏–∑–Ω–µ—Å:      X,XXX,XXX ‚ÇΩ          ‚ïë
‚ïë  –ò–¢–û–ì–û:         X,XXX,XXX ‚ÇΩ          ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  –¢–û–ü –†–ê–°–•–û–î–û–í (—ç—Ç–æ—Ç –º–µ—Å—è—Ü)           ‚ïë
‚ïë  1. –ó–∞–∫—É–ø–∫–∏:    X,XXX,XXX ‚ÇΩ  (XX%)   ‚ïë
‚ïë  2. –ù–∞–ª–æ–≥–∏:     XXX,XXX ‚ÇΩ    (XX%)   ‚ïë
‚ïë  3. –ó–∞—Ä–ø–ª–∞—Ç–∞:   XXX,XXX ‚ÇΩ    (XX%)   ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –í–ù–ò–ú–ê–ù–ò–Ø                 ‚ïë
‚ïë  –ù–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: N      ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

---

## Python: –°–æ–∑–¥–∞–Ω–∏–µ –ª–∏—Å—Ç–æ–≤ dashboard

```python
import gspread
from pathlib import Path
from typing import List

# –°–ø–∏—Å–æ–∫ –º–µ—Å—è—Ü–µ–≤ –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫ P&L (–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏)
def generate_month_columns(start_year: int = 2025, months: int = 24) -> List[str]:
    """–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –º–µ—Å—è—Ü–µ–≤ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∫–æ–ª–æ–Ω–æ–∫."""
    from datetime import date
    result = []
    month = date(start_year, 1, 1)
    for _ in range(months):
        result.append(month.strftime("%Y-%m"))
        if month.month == 12:
            month = date(month.year + 1, 1, 1)
        else:
            month = date(month.year, month.month + 1, 1)
    return result


EXPENSE_CATEGORIES = [
    "–ù–∞–ª–æ–≥–∏", "–ó–∞—Ä–ø–ª–∞—Ç–∞", "–ü–æ–¥—Ä—è–¥—á–∏–∫–∏", "–ê—Ä–µ–Ω–¥–∞", "–ó–∞–∫—É–ø–∫–∏",
    "–õ–æ–≥–∏—Å—Ç–∏–∫–∞", "–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥", "–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è", "IT –∏ —Å–µ—Ä–≤–∏—Å—ã",
    "–û—Ñ–∏—Å", "–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–¥—ã",
]

INCOME_CATEGORIES = ["–í—ã—Ä—É—á–∫–∞", "–ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã"]


def setup_dashboard_sheets(spreadsheet: gspread.Spreadsheet) -> None:
    """
    –°–æ–∑–¥–∞—Ç—å –ª–∏—Å—Ç—ã P&L, Cash Flow, –†–∞—Å—Ö–æ–¥—ã, –ò—Ç–æ–≥–æ –≤ —Ç–∞–±–ª–∏—Ü–µ.
    –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –ª–∏—Å—Ç–∞ "–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π".
    """
    months = generate_month_columns()
    existing = {ws.title for ws in spreadsheet.worksheets()}

    # === P&L –ª–∏—Å—Ç ===
    if "P&L" not in existing:
        ws_pl = spreadsheet.add_worksheet("P&L", rows=50, cols=len(months) + 3)

        # –ó–∞–≥–æ–ª–æ–≤–∫–∏
        headers = ["–ö–∞—Ç–µ–≥–æ—Ä–∏—è"] + months + ["–ò–¢–û–ì–û"]
        ws_pl.update("A1", [headers])

        # –°–µ–∫—Ü–∏—è –¥–æ—Ö–æ–¥–æ–≤
        ws_pl.update("A2", [["–î–û–•–û–î–´"]])
        for i, cat in enumerate(INCOME_CATEGORIES, start=3):
            ws_pl.update(f"A{i}", [[cat]])

        income_end = 2 + len(INCOME_CATEGORIES)
        ws_pl.update(f"A{income_end + 1}", [["‚îÄ‚îÄ –ò—Ç–æ–≥–æ –¥–æ—Ö–æ–¥–æ–≤ ‚îÄ‚îÄ"]])

        # –°–µ–∫—Ü–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤
        ws_pl.update(f"A{income_end + 3}", [["–†–ê–°–•–û–î–´"]])
        for i, cat in enumerate(EXPENSE_CATEGORIES, start=income_end + 4):
            ws_pl.update(f"A{i}", [[cat]])

        expense_end = income_end + 3 + len(EXPENSE_CATEGORIES)
        ws_pl.update(f"A{expense_end + 1}", [["‚îÄ‚îÄ –ò—Ç–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–æ–≤ ‚îÄ‚îÄ"]])
        ws_pl.update(f"A{expense_end + 3}", [["–ü–†–ò–ë–´–õ–¨"]])

        # TODO: –î–æ–±–∞–≤–∏—Ç—å SUMPRODUCT —Ñ–æ—Ä–º—É–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–π —è—á–µ–π–∫–∏
        # (–¥–µ–ª–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–∫—Ä–∏–ø—Ç–æ–º –∏–ª–∏ –≤—Ä—É—á–Ω—É—é –≤ Sheets)

    # === Cash Flow –ª–∏—Å—Ç ===
    if "Cash Flow" not in existing:
        ws_cf = spreadsheet.add_worksheet("Cash Flow", rows=30, cols=5)
        ws_cf.update("A1", [["–Æ—Ä–ª–∏—Ü–æ", "–ë–∞–Ω–∫", "–°—á—ë—Ç", "–û—Å—Ç–∞—Ç–æ–∫", "–û–±–Ω–æ–≤–ª–µ–Ω–æ"]])

    # === –†–∞—Å—Ö–æ–¥—ã –ª–∏—Å—Ç ===
    if "–†–∞—Å—Ö–æ–¥—ã" not in existing:
        ws_exp = spreadsheet.add_worksheet("–†–∞—Å—Ö–æ–¥—ã", rows=30, cols=len(months) + 3)
        headers = ["–ö–∞—Ç–µ–≥–æ—Ä–∏—è"] + months + ["–ò–¢–û–ì–û", "%"]
        ws_exp.update("A1", [headers])
        for i, cat in enumerate(EXPENSE_CATEGORIES, start=2):
            ws_exp.update(f"A{i}", [[cat]])

    print("Dashboard –ª–∏—Å—Ç—ã —Å–æ–∑–¥–∞–Ω—ã. –î–æ–±–∞–≤—å—Ç–µ SUMPRODUCT —Ñ–æ—Ä–º—É–ª—ã –¥–ª—è –¥–∞–Ω–Ω—ã—Ö.")
```

---

## –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è /report —á–µ—Ä–µ–∑ API

```python
class FinancialSheetsManager:
    """–ö–ª–∞—Å—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ Google Sheets."""

    def get_monthly_stats(self, month: str) -> dict:
        """
        –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –º–µ—Å—è—Ü –∏–∑ –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

        Args:
            month: –§–æ—Ä–º–∞—Ç "YYYY-MM"

        Returns:
            {'income': float, 'total_expense': float, 'by_category': {cat: float}}
        """
        ws = self.spreadsheet.worksheet("–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π")
        rows = ws.get_all_values()[1:]  # –ë–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞

        income = 0.0
        expenses_by_cat: dict[str, float] = {}

        for row in rows:
            if len(row) < 17:
                continue
            # –ö–æ–ª–æ–Ω–∫–∏: B=date, F=direction, G=amount, L=category, N=is_internal, Q=month
            row_month = row[16] if len(row) > 16 else ""
            if row_month != month:
                continue

            direction = row[5]
            amount = float(row[6] or 0)
            category = row[11]
            is_internal = row[13].upper() == "TRUE"

            if is_internal:
                continue

            if direction == "IN" and category in ("–í—ã—Ä—É—á–∫–∞", "–ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã"):
                income += amount
            elif direction == "OUT":
                expenses_by_cat[category] = expenses_by_cat.get(category, 0) + amount

        return {
            "income": income,
            "total_expense": sum(expenses_by_cat.values()),
            "by_category": expenses_by_cat,
        }

    def get_account_balances(self) -> list[dict]:
        """–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ —Å—á–µ—Ç–∞–º –∏–∑ –ª–∏—Å—Ç–∞ Cash Flow."""
        ws = self.spreadsheet.worksheet("Cash Flow")
        rows = ws.get_all_values()[1:]
        return [
            {"entity": r[0], "bank": r[1], "account": r[2], "balance": float(r[3] or 0)}
            for r in rows if len(r) >= 4 and r[2]
        ]

    def get_uncategorized_transactions(self, limit: int = 20) -> list[dict]:
        """–ü–æ–ª—É—á–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ü—Ä–æ—á–µ–µ –∏–ª–∏ –ø—É—Å—Ç–∞—è)."""
        ws = self.spreadsheet.worksheet("–ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π")
        rows = ws.get_all_values()[1:]
        result = []
        for row in rows:
            if len(row) < 12:
                continue
            category = row[11]
            if category in ("–ü—Ä–æ—á–µ–µ", "", "–ù–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ"):
                result.append({
                    "tx_id": row[0],
                    "date": row[1],
                    "direction": row[5],
                    "amount": float(row[6] or 0),
                    "counterparty": row[8],
                    "purpose": row[10],
                })
        return result[:limit]
```

---

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ /report –≤ Telegram

```
üìä P&L –∑–∞ 2026-01

üì• –í—ã—Ä—É—á–∫–∞: 3,890,000 ‚ÇΩ

üì§ –†–∞—Å—Ö–æ–¥—ã: 2,847,000 ‚ÇΩ
  ‚îî –ó–∞–∫—É–ø–∫–∏: 1,450,000 ‚ÇΩ
  ‚îî –ù–∞–ª–æ–≥–∏: 427,000 ‚ÇΩ
  ‚îî –ó–∞—Ä–ø–ª–∞—Ç–∞: 350,000 ‚ÇΩ
  ‚îî –õ–æ–≥–∏—Å—Ç–∏–∫–∞: 195,000 ‚ÇΩ
  ‚îî –ê—Ä–µ–Ω–¥–∞: 120,000 ‚ÇΩ
  ‚îî –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–¥—ã: 29,000 ‚ÇΩ
  ‚îî –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥: 85,000 ‚ÇΩ
  ‚îî –ü—Ä–æ—á–µ–µ: 191,000 ‚ÇΩ

üü¢ –ü—Ä–∏–±—ã–ª—å: 1,043,000 ‚ÇΩ
```

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Å–∫–∏–ª–ª—ã

- `/financial-journal-schema` ‚Äî –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–Ω–∞—á–∞–ª–∞)
- `/bank-import-bot` ‚Äî –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∂—É—Ä–Ω–∞–ª
- `/bank-statement-parser` ‚Äî –ü–∞—Ä—Å–∏–Ω–≥ –≤—ã–ø–∏—Å–æ–∫
- `/transaction-categorizer` ‚Äî –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è —Ç–æ—á–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
