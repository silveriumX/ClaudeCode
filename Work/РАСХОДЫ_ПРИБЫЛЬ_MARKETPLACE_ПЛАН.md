# Свод расходов и прибыли по компании (Marketplace) — план и контекст для Cursor

**Цель:** посчитать расходы и прибыль за предыдущие периоды при фрагментированной структуре учёта. Минимум ручной работы; максимум — через нейросети и существующие системы (Finance Bot).

**Обновлено:** 11.02.2026

---

## 1. Суть Finance Bot (что уже есть)

Finance Bot — Telegram-бот для управления **заявками на выплаты** с записью в Google Sheets.

### Что он делает
- **Заявки на выплаты** в валютах: RUB, BYN, KZT, USDT, CNY.
- **Категории** определяются автоматически по назначению платежа: Маркетинг, Логистика, Зарплата, Закупки, Офис, Разработка, Налоги, Услуги, Прочее.
- **Листы в таблице:** Основные (RUB), Разные выплаты (BYN), USDT, USDT Зарплаты, CNY, **Фактические расходы** (наличные RUB без заявки).
- Роли: owner, manager, executor, report (учётчик — кнопка «Внести расход» для фактических расходов).

### Что уже даёт прозрачность
- Все операции через бота попадают в одну Google-таблицу.
- Есть дата, сумма, получатель, назначение, категория, статус (Создана / Оплачена / Факт).
- Фактические расходы (наличные) пишутся на отдельный лист «Фактические расходы».

### Чего пока нет
- Единого свода по **всем** источникам расходов (бот + разрозненные журналы, эксели, выписки).
- Расчёта **прибыли** (нужны доходы с маркетплейсов и свод расходов).
- Автоматического подтягивания данных из внешних источников (маркетплейсы, банки, сервисы).

---

## 2. Простой пошаговый план (что делать дальше)

### Шаг 1. Зафиксировать источники данных (ничего не считать, только перечислить)
- [ ] Список всех мест, где лежат расходы: Finance Bot (Google Sheets), Excel-файлы, выписки банков, чеки, «киска» (если это сервис/касса — указать что именно), другие сервисы.
- [ ] Список мест, где лежат **доходы**: отчёты маркетплейсов (Ozon, WB, и т.д.), выписки по расчётам, эксели.

### Шаг 2. Зафиксировать статьи расходов (единый словарь)
Использовать один и тот же набор статей везде, чтобы потом сводить:

| Статья           | Примеры / примечание |
|------------------|----------------------|
| Зарплаты         | оклад, аванс, премия, бонус |
| Сервисы          | подписки, софт, маркетплейс-комиссии, «киска» (уточнить) |
| Закупки товаров  | оплата поставщикам, товар, партия |
| Налоги           | налог, взносы, бухгалтерия |
| Логистика        | доставка, курьер, СДЭК, транспорт |
| Маркетинг        | реклама, таргет, дизайн |
| Офис             | аренда, связь, интернет |
| Разработка       | программист, сайт, приложение |
| Услуги           | юрист, консультация, подряд |
| Прочее           | всё остальное |

### Шаг 3. Решить, что ведём только через Finance Bot с текущего момента
- Все новые расходы проводить через бота (заявки или «Внести расход»).
- Так будущие периоды будут уже в одной структуре.

### Шаг 4. Ретро: один период и один источник
- Выбрать **один** прошлый период (например, январь 2026) и **один** источник (например, только лист «Основные» в Finance Bot).
- Выписать/экспорт: дата, сумма, назначение, категория. Проверить, что категории совпадают со словарём из шага 2.

### Шаг 5. Добавить остальные источники по тому же периоду
- По тому же периоду добавить: Разные выплаты, USDT, CNY, Фактические расходы.
- Потом — выписки/эксели по тому же периоду: привести к одной валюте (RUB), одной структуре (дата, сумма, статья из словаря).

### Шаг 6. Свод за период
- Таблица: по строкам — статьи расходов, по колонкам — источник (или одна колонка «всего»). Итог по периоду.
- Доходы за тот же период (маркетплейсы) — отдельно. Прибыль = доходы − расходы (по периоду).

### Шаг 7. Автоматизация и нейросети (после того как ручной свод за 1 период есть)
- Описать в Cursor: какие файлы/листы использовать, в каком формате отдавать выгрузки.
- Запросы вида: «по этим выгрузкам посчитай расходы по статьям за период X» или «сведи в одну таблицу по шаблону».
- При наличии API маркетплейсов/банков — обсудить автоматическую выгрузку (отдельная задача).

---

## 3. Что предоставить в Cursor, чтобы сформировать такие же идеи и расчёты

Чтобы я (или другой агент) мог подсказывать формулы, структуру таблиц и шаги:

### 3.1 Элементы системы (опиши текстом или списком)
- Названия всех **листов** в вашей основной Google-таблице Finance Bot.
- Какие **ещё системы/файлы** участвуют в учёте: эксели, выписки, «киска», сервисы (названия).
- Какие **маркетплейсы** и в каком виде приходят отчёты (скачиваемый Excel/CSV, личный кабинет без выгрузки и т.д.).

### 3.2 Статьи расходов (можно скопировать и дополнить)
```
Зарплаты
Сервисы (в т.ч. киска — уточнить что это)
Закупки товаров
Налоги
Логистика
Маркетинг
Офис
Разработка
Услуги
Прочее
```

### 3.3 Примеры вопросов, которые можно задавать в Cursor
- «По структуре листов Finance Bot (см. Work/РАСХОДЫ_ПРИБЫЛЬ_MARKETPLACE_ПЛАН.md) предложи формулу свода расходов по статьям за месяц по листу Основные».
- «У меня есть выгрузка из [источник]: колонки [перечисли]. Как привести к формату: дата, сумма RUB, статья из словаря статей?»
- «Как посчитать прибыль за период: у меня доход с маркетплейса в файле X, расходы в таблице Finance Bot по листам Y, Z?»
- «Дополни словарь статей в РАСХОДЫ_ПРИБЫЛЬ_MARKETPLACE_ПЛАН.md статьёй "Киска" с пояснением».

### 3.4 Голосовая заметка (дополнение)
Если в голосовой заметке есть:
- названия сервисов или файлов — добавь их в раздел «Элементы системы» ниже.
- уточнение по «киска» (касса, сервис, приложение) — добавь в раздел статей и в словарь.
- конкретные периоды или маркетплейсы — добавь в раздел «Периоды и источники» ниже.

---

## 4. Метод определения элементов системы (как составить список)

### 4.1 Карта движения денег (от источника к расходам)

```
МАРКЕТПЛЕЙСЫ (Ozon, WB, ...)
  ↓ (выручка, реклама, комиссии)
  ↓
РАСЧЁТНЫЙ СЧЁТ (банк)
  ↓
  ├─→ Налоги (автоматически или вручную)
  ├─→ Обслуживание банков
  ├─→ Подписки (сервисы)
  ├─→ Зарплаты (онлайн и оффлайн сотрудники)
  ├─→ Премии / бонусы / пешника
  ├─→ Аренда (офис, склад)
  ├─→ Фулфилмент и упаковка товара
  ├─→ Закупки товаров
  └─→ Прочие расходы
```

### 4.2 Пошаговая инвентаризация

#### Шаг А. Перечислить ДОХОДЫ (откуда деньги приходят)
- [ ] Названия маркетплейсов: _[Ozon, WB, ...]_
- [ ] Формат отчётов: _[личный кабинет: скачать Excel/CSV, есть API, только просмотр без выгрузки]_
- [ ] Где хранятся выгрузки: _[папка на ПК, Google Drive, ...]_
- [ ] Итоговая цифра = выручка или уже за вычетом комиссий маркетплейса?

#### Шаг Б. Перечислить РАСХОДЫ маркетплейса (которые маркетплейс сам списывает)
- [ ] Реклама (маркетплейс списывает сам) — _где видно сумму: в отчёте МП, в личном кабинете?_
- [ ] Подписки на маркетплейсе (тарифы) — _где видно: в отчёте, в выписке?_
- [ ] Комиссии маркетплейса (если не входят в выручку) — _где видно?_
- [ ] СПП (?) — _что это, где видно сумму?_

#### Шаг В. Перечислить РАСХОДЫ с расчётного счёта (куда уходят деньги после прихода с МП)
- [ ] **Налоги** — _откуда данные: выписка банка, бухгалтерия, 1С?_
- [ ] **Обслуживание банков** — _выписка банка, договор?_
- [ ] **Подписки (сервисы, софт)** — _список сервисов: [...]_
- [ ] **Зарплаты онлайн-сотрудников** — _Finance Bot / ведомость / выписка?_
- [ ] **Зарплаты оффлайн-сотрудников** — _ведомость / касса / выписка?_
- [ ] **Премии / бонусы / пешника (%)** — _Finance Bot / отдельный файл?_
- [ ] **Аренда** — _договор аренды, выписка банка?_
- [ ] **Фулфилмент** — _счета от фулфилмент-оператора, выписка?_
- [ ] **Упаковка товара** — _счета поставщика упаковки, выписка?_
- [ ] **Закупки товаров** — _счета поставщиков, выписка?_
- [ ] **Прочие** — _что ещё списывается?_

#### Шаг Г. Где эти данные лежат (источники файлов)
- [ ] **Finance Bot (Google Sheets)** — _листы: Основные, Разные выплаты, USDT, Фактические расходы_
- [ ] **Выписка банка** — _формат: Excel/PDF/1С, как часто скачиваем?_
- [ ] **Отчёты маркетплейсов** — _где: личные кабинеты, папка с файлами_
- [ ] **Бухгалтерия (1С / другой учёт)** — _есть доступ? формат выгрузки?_
- [ ] **Ведомости зарплат** — _Excel-файл, Google Sheets?_
- [ ] **Счета от поставщиков** — _папка с PDF/скан, Google Drive?_
- [ ] **Крипто-кошельки (Trust Wallet и др.)** — _см. раздел 4.4 ниже_
- [ ] **Прочие файлы/сервисы** — _[перечисли]_

#### Шаг Д. Инвентаризация крипто-кошельков и расходов (USDT TRC20)

**ПРОБЛЕМА:** кошельки "намешаны", непонятно какой для чего используется, нет общей картины баланса.

**УТОЧНЕНИЕ:** все кошельки работают с **USDT в сети TRC20** (Tron), других токенов нет.

**РЕШЕНИЕ:** инвентаризация + именование + сервис отслеживания.

**Шаги:**

1. **Перечислить все TRC20 кошельки:**
   - [ ] Trust Wallet кошелёк 1 — адрес: _[T...]_ (TRC20/Tron)
   - [ ] Trust Wallet кошелёк 2 — адрес: _[T...]_ (TRC20/Tron)
   - [ ] Другие кошельки (Tronlink, биржи) — _[перечисли]_

2. **Определить назначение каждого кошелька** (по истории транзакций):
   - [ ] Кошелёк А → зарплаты в USDT (Finance Bot, лист USDT Зарплаты)
   - [ ] Кошелёк Б → оплата поставщикам в USDT
   - [ ] Кошелёк В → операционные расходы (подписки, сервисы)
   - [ ] Кошелёк Г → резерв / холд
   - [ ] _[добавь остальные по факту использования]_

3. **Переименовать в Trust Wallet:**
   - Trust Wallet позволяет добавить метку к кошельку.
   - Использовать понятные имена: «Зарплаты USDT», «Поставщики крипта», «Операционка», «Резерв».

4. **Подключить к сервису отслеживания общего баланса TRC20:**

   **Рекомендуемые сервисы для Tron/TRC20:**

   | Сервис | Поддержка TRC20 | Фичи | Ссылка |
   |--------|-----------------|------|--------|
   | **Tronscan** ⭐ | Полная (нативно) | Баланс USDT TRC20, история транзакций, несколько адресов, экспорт CSV | https://tronscan.org/ |
   | **CoinStats** | Да (+ биржи) | Портфолио, поддержка Tron + биржи, мобильное приложение | https://coinstats.app/ |
   | **Blockchair** | Да | Blockchain explorer + портфолио, история, API | https://blockchair.com/tron |
   | **DeBank** | Да | Портфолио, мультичейн (включая Tron) | https://debank.com/ |

   **Рекомендация:** для TRC20 USDT лучше всего использовать:
   - **Tronscan** (бесплатно, нативная поддержка Tron, можно добавить несколько адресов в Watchlist)
   - **CoinStats** (если нужно также отслеживать биржи и другие сети)

   **Как использовать Tronscan:**
   1. Зайти на https://tronscan.org/
   2. Создать аккаунт (опционально, но удобно для Watchlist)
   3. Добавить адреса в Watchlist: Menu → Watchlist → Add Address
   4. Дать каждому адресу метку (например: «Зарплаты», «Поставщики»)
   5. Видеть общий баланс USDT и историю транзакций всех кошельков на одной странице

5. **Связать с Finance Bot:**
   - Транзакции из крипто-кошельков, которые идут через Finance Bot (лист USDT, USDT Зарплаты), уже учитываются.
   - Для расходов **не через бота** (прямые переводы с кошелька) — нужно либо:
     - вносить вручную в Finance Bot как «Фактический расход USDT» (если редкие),
     - или вести отдельный лист «Крипто прямые расходы» (если много).
   - Можно экспортировать историю из Tronscan в CSV и импортировать в Google Sheets для анализа.

### 4.4 Таблица TRC20 кошельков для инвентаризации

| Название (метка) | Адрес (TRC20) | Назначение | Связь с Finance Bot | Баланс USDT |
|------------------|---------------|------------|---------------------|-------------|
| Зарплаты USDT | T... | Выплаты зарплат сотрудникам | Да (лист USDT Зарплаты) | _[из Tronscan]_ |
| Поставщики крипта | T... | Оплата поставщикам в USDT | Частично (Finance Bot) | _[из Tronscan]_ |
| Операционка | T... | Подписки, сервисы в USDT | Нет (прямые переводы) | _[из Tronscan]_ |
| Резерв | T... | Холд, резервный фонд | Нет | _[из Tronscan]_ |
| _[добавь кошельки]_ | T... | ... | ... | ... |

**ИТОГО USDT TRC20:** _[сумма из Tronscan Watchlist]_

**Преимущества TRC20:**
- Низкие комиссии (в отличие от Ethereum)
- Быстрые транзакции
- Простота отслеживания (один токен USDT, одна сеть Tron)

### 4.3 Итоговая таблица элементов системы (заполни после инвентаризации)

| Элемент | Тип | Источник данных | Формат | Частота |
|---------|-----|-----------------|--------|---------|
| Выручка Ozon | Доход | Личный кабинет Ozon | Excel выгрузка | Ежемесячно |
| Выручка WB | Доход | Личный кабинет WB | Excel выгрузка | Ежемесячно |
| Реклама Ozon | Расход МП | Отчёт Ozon | В выгрузке, колонка X | Ежемесячно |
| Налоги | Расход | Выписка банка / 1С | Excel | Ежеквартально |
| Обслуживание банка | Расход | Выписка банка | Excel | Ежемесячно |
| Подписки | Расход | Finance Bot + выписка | Google Sheets | По операциям |
| Зарплаты онлайн | Расход | Finance Bot (лист USDT Зарплаты) | Google Sheets | По операциям |
| Зарплаты оффлайн | Расход | Ведомость / касса | Excel / бумага | Ежемесячно |
| Премии/бонусы | Расход | Finance Bot или ведомость | Google Sheets | По операциям |
| Аренда | Расход | Договор / выписка банка | PDF + выписка | Ежемесячно |
| Фулфилмент | Расход | Счета оператора | PDF / выписка | Ежемесячно |
| Упаковка | Расход | Счета поставщика | PDF / выписка | По закупкам |
| Закупки товаров | Расход | Счета поставщиков | PDF / выписка | По закупкам |
| Крипто-расходы прямые | Расход | История TRC20 кошельков + Tronscan | Blockchain (USDT TRC20) | По операциям |

_Добавь недостающие строки по твоим источникам._

---

## 5. Заполняемые блоки (текущий статус инвентаризации)

### Элементы системы (выявленные)
- **Листы Finance Bot:** Основные, Разные выплаты, USDT, USDT Зарплаты, CNY, Фактические расходы, Пользователи, Расчётный баланс, Баланс счетов, Лог событий.
- **Другие источники расходов:** выписка банка, отчёты маркетплейсов, счета поставщиков, ведомости зарплат, история крипто-кошельков (Trust Wallet), _[добавь остальные]_
- **Источники доходов (маркетплейсы):** _[например: Ozon, WB — в каком формате отчёты, где лежат файлы]_
- **Крипто-кошельки:** см. таблицу в разделе 4.4 — нужна инвентаризация и подключение к сервису отслеживания (**Tronscan** рекомендуется для TRC20 USDT)

### Расходные статьи (детализация)
#### Маркетплейс (расходы, которые МП сам списывает):
- Реклама на маркетплейсе
- Подписки (тарифы маркетплейса)
- Комиссии маркетплейса
- СПП (уточнить что это)

#### Операционные расходы (с расчётного счёта):
- Налоги
- Обслуживание банков
- Подписки на сервисы (не МП)
- Зарплаты онлайн-сотрудников
- Зарплаты оффлайн-сотрудников
- Премии / бонусы / пешника (процент с продаж?)
- Аренда (офис, склад)
- Фулфилмент (услуги упаковки, хранения, отправки)
- Упаковка товара (материалы)
- Закупки товаров (оплата поставщикам)

### Периоды и источники для первого свода
- **Первый период для ретро:** _[например: январь 2026]_
- **Источники по этому периоду:** _[например: Finance Bot (листы Основные, USDT Зарплаты) + выписка банка + отчёты Ozon/WB]_

### Уточнения
- **«СПП»:** _[что это — способ продажи/продвижения, система скидок? где видно сумму?]_
- **«Пешника»:** _[процент с продаж для менеджеров/продавцов? фиксированная премия?]_

---

## 6. Ссылки на документацию Finance Bot

- Структура листов и колонок: `Projects/FinanceBot/docs/SHEETS_STRUCTURE.md`
- Категории платежей (код): `Projects/FinanceBot/utils/categories.py`
- Конфиг листов: `Projects/FinanceBot/config.py`

После заполнения блоков из раздела 4 можно давать этот файл в контекст при запросах по расчётам и своду расходов/прибыли.
