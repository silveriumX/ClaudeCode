"""
Автоматическое определение категорий платежей
"""

# Словарь категорий и ключевых слов
CATEGORIES = {
    'Пополнение площадки': [
        'пополнение', 'транзит', 'транзитный', 'bippapa', 'биппапа',
        'p2p', 'площадка', 'пополнить', 'перевод на кошелек', 'перевод на площадку'
    ],
    'Маркетинг': [
        'дизайн', 'макет', 'реклама', 'таргет', 'seo', 'продвижение',
        'баннер', 'креатив', 'контекст', 'ведение', 'smm', 'пиар'
    ],
    'Логистика': [
        'доставка', 'курьер', 'транспорт', 'отправка', 'почта',
        'cdek', 'сдэк', 'пэк', 'boxberry', 'груз', 'перевозка'
    ],
    'Зарплата': [
        'зарплата', 'з/п', 'зп', 'оклад', 'премия', 'аванс',
        'выплата', 'вознаграждение', 'бонус'
    ],
    'Закупки': [
        'закупка', 'товар', 'оплата поставщику', 'материалы',
        'партия', 'заказ', 'товарка', 'поставка'
    ],
    'Офис': [
        'аренда', 'коммуналка', 'интернет', 'связь', 'канцелярия',
        'офис', 'помещение', 'электричество', 'вода', 'телефон'
    ],
    'Разработка': [
        'программист', 'верстка', 'сайт', 'приложение', 'код',
        'backend', 'frontend', 'разработка', 'dev', 'тестирование'
    ],
    'Налоги': [
        'налог', 'фнс', 'взнос', 'ндфл', 'усн', 'ип',
        'бухгалтерия', 'отчетность'
    ],
    'Услуги': [
        'услуга', 'консультация', 'юрист', 'бухгалтер', 'аудит',
        'аутсорс', 'подряд'
    ]
}


def determine_category(purpose: str) -> str:
    """
    Определить категорию платежа по назначению

    Args:
        purpose: Назначение платежа (текст)

    Returns:
        Название категории или 'Прочее' если не определено
    """
    if not purpose:
        return 'Прочее'

    # Приводим к нижнему регистру для поиска
    purpose_lower = purpose.lower()

    # Ищем совпадения по ключевым словам
    for category, keywords in CATEGORIES.items():
        for keyword in keywords:
            if keyword in purpose_lower:
                return category

    # Если ничего не найдено
    return 'Прочее'


def get_all_categories() -> list:
    """Получить список всех категорий"""
    return list(CATEGORIES.keys()) + ['Прочее']


def add_keyword_to_category(category: str, keyword: str):
    """
    Добавить новое ключевое слово в категорию
    (для возможного расширения)
    """
    if category in CATEGORIES:
        if keyword.lower() not in CATEGORIES[category]:
            CATEGORIES[category].append(keyword.lower())
        return True
    return False
