"""
Альтернативный способ: получить информацию для ручного создания
Из-за quota exceeded на service account нужно создать таблицу от своего аккаунта
"""
import json

# Прочитать service account email
with open('service_account.json', 'r') as f:
    sa_data = json.load(f)
    sa_email = sa_data['client_email']

FOLDER_ID = '1H2rIofCknpGXHo-px0zw-PJsdhPvnUdv'

print("=" * 70)
print("ПРОБЛЕМА: Service account quota exceeded")
print("=" * 70)
print()
print("РЕШЕНИЕ: Создай таблицу от своего Google аккаунта:")
print()
print("ШАГ 1: Открой папку:")
print(f"https://drive.google.com/drive/folders/{FOLDER_ID}")
print()
print("ШАГ 2: Создай таблицу:")
print("  - Нажми: + New → Google Sheets → Blank spreadsheet")
print("  - Назови: ChatManager Database")
print()
print("ШАГ 3: Создай 3 листа (переименуй Sheet1 и добавь 2 новых):")
print()
print("ЛИСТ 1: 'Пользователи' (5 колонок)")
print("  A1: telegram_id")
print("  B1: имя")
print("  C1: username")
print("  D1: роль")
print("  E1: статус")
print()
print("  Добавь себя во вторую строку:")
print("  A2: твой_telegram_id (узнай через @userinfobot)")
print("  B2: Твоё Имя")
print("  C2: твой_username")
print("  D2: admin")
print("  E2: active")
print()
print("ЛИСТ 2: 'Чаты' (8 колонок)")
print("  A1: id")
print("  B1: название")
print("  C1: creator_id")
print("  D1: дата_создания")
print("  E1: статус")
print("  F1: invite_link")
print("  G1: chat_id")
print("  H1: описание")
print("  (больше ничего не добавляй - бот заполнит)")
print()
print("ЛИСТ 3: 'Участники' (4 колонки)")
print("  A1: chat_id")
print("  B1: user_id")
print("  C1: роль_в_чате")
print("  D1: дата_добавления")
print("  (больше ничего не добавляй - бот заполнит)")
print()
print("ШАГ 4: Дать доступ service account:")
print(f"  - Нажми Share в правом верхнем углу таблицы")
print(f"  - Вставь email: {sa_email}")
print(f"  - Выбери роль: Editor")
print(f"  - Сними галочку 'Notify people'")
print(f"  - Нажми Share")
print()
print("ШАГ 5: Скопировать ID таблицы:")
print("  Из URL: https://docs.google.com/spreadsheets/d/ВОТ_ЭТОТ_ID/edit")
print()
print("ШАГ 6: Обновить .env:")
print("  GOOGLE_SHEETS_ID=твой_скопированный_id")
print()
print("ШАГ 7: Проверить:")
print("  python test_system.py")
print()
print("=" * 70)
print(f"Service Account Email для Share: {sa_email}")
print("=" * 70)
