# Как сделать, чтобы Voice‑бот расшифровывал голосовые в группе/канале

## Важно: два разных сценария

### 1. Голосовые сообщения в чате (то, что умеет бот)

Участники отправляют **голосовые сообщения** в общий чат (кнопка микрофона рядом с полем ввода → запись → отправка). Это обычные сообщения с типом «голос». Бот их видит и может расшифровывать.

### 2. Голосовой чат / эфир (это бот не умеет)

Когда в группе включают **«Голосовой чат»** (Voice Chat) и люди говорят в реальном времени — это **не** голосовые сообщения. Telegram Bot API **не даёт** ботам доступа к этому аудиопотоку. Расшифровать живой разговор в голосовом канале через такого бота технически нельзя.

**Итог:** бот расшифровывает только **голосовые сообщения**, отправленные в чат (или в канал как пост). Не то, что говорят в эфире голосового чата.

---

## Что проверить, если бот не расшифровывает в группе

### 1. Режим приватности (Privacy mode)

По умолчанию у бота включён **режим приватности**. В этом режиме в группах он получает только:

- сообщения, начинающиеся с `/`;
- ответы на свои сообщения;
- служебные сообщения (вход/выход участников).

Обычные голосовые сообщения без упоминания бота он **не видит**.

**Что сделать:**

1. Открой [@BotFather](https://t.me/BotFather).
2. Отправь `/setprivacy`.
3. Выбери своего Voice‑бота.
4. Нажми **Disable** (отключить режим приватности).

После этого бот начнёт получать **все** сообщения в группе, в том числе голосовые.

**Если бот уже админ:** по правилам Telegram админ‑бот и так получает все сообщения, независимо от режима приватности. Тогда причина может быть в другом (см. ниже).

### 2. Бот добавлен именно в чат группы

Бот должен быть участником **чата** (группы или супергруппы), а не только «в списке» голосового чата. Добавление в группу: «Добавить участников» → выбрать бота. После этого голосовые, которые шлют **в этот чат**, бот сможет получать и расшифровывать.

### 3. Голосовые шлют в чат, а не только в эфир

Расшифровка возможна только для **голосовых сообщений** в переписке: кто‑то нажал микрофон, записал и отправил в общий чат. То, что говорят только в голосовом эфире, бот не слышит.

### 4. Канал, а не группа

Если бот добавлен в **канал**: он должен быть **администратором** канала с правом видеть посты. В коде бота должна быть поддержка типа чата `channel` и обработка `channel_post` (в этой версии проекта она добавлена — см. ниже). После деплоя обновлённого кода и перезапуска бот сможет расшифровывать голосовые в постах канала.

---

## Краткий чеклист

| Шаг | Действие |
|-----|----------|
| 1 | Убедиться, что нужна расшифровка **голосовых сообщений в чате**, а не эфира голосового чата. |
| 2 | В @BotFather: `/setprivacy` → выбрать бота → **Disable**. |
| 3 | Добавить бота в группу (или в канал и выдать права админа). |
| 4 | Отправить в чат группы (или в канал) **голосовое сообщение** и проверить, что бот на него отвечает. |
| 5 | Если используешь канал — задеплоить версию с поддержкой `channel_post` и перезапустить бота. |

После этого бот будет расшифровывать голосовые сообщения в выбранной группе или канале (но не живой голосовой эфир).
