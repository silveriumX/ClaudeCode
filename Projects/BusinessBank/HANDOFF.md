# HANDOFF ‚Äî –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ / –ü–∞—Ä—Å–µ—Ä –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –≤—ã–ø–∏—Å–æ–∫
**–î–∞—Ç–∞:** 20.02.2026
**–°—Ç–∞—Ç—É—Å:** –§–∞–∑–∞ 1 ‚úÖ + –§–∞–∑–∞ 2 (fb_adapter + merge_pnl) ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

## –ß–¢–û –°–î–ï–õ–ê–ù–û –í –≠–¢–û–ô –°–ï–°–°–ò–ò (20.02.2026)

### 1. –°–≤–æ–¥–Ω—ã–π P&L: merge_pnl.py ‚úÖ –ù–û–í–û–ï

**–§–∞–π–ª—ã:**
```
Projects/BusinessBank/
  src/
    fb_adapter.py    ‚Äî –∞–¥–∞–ø—Ç–µ—Ä FinanceBot Sheets ‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π DataFrame
  clusters.json      ‚Äî –∫–æ–Ω—Ñ–∏–≥ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, entity_patterns, fx_rates
  merge_pnl.py       ‚Äî —Å–≤–æ–¥–Ω—ã–π P&L: –±–∞–Ω–∫ + FinanceBot ‚Üí Excel (4 –ª–∏—Å—Ç–∞)
```

**–ó–∞–ø—É—Å–∫ (—Ç–æ–ª—å–∫–æ –±–∞–Ω–∫):**
```bash
python -X utf8 merge_pnl.py \
  --bank "–ü—Ä–∏–º–µ—Ä—ã –≤—ã–ø–∏—Å–æ–∫ –∏–∑ –ú–æ–¥—É–ª—å–±–∞–Ω–∫–∞/Statement.xlsx" \
  --entity DBZ \
  --owner "–ü–∏—Ä–æ–∂–∫–æ–≤–∞ –ù–∞—Ç–∞–ª—å—è –í–∏–∫—Ç–æ—Ä–æ–≤–Ω–∞" \
  --out pnl_DBZ_bank_only.xlsx \
  --last-months 6
```

**–ó–∞–ø—É—Å–∫ (–±–∞–Ω–∫ + FinanceBot):**
```bash
python -X utf8 merge_pnl.py \
  --bank "–ü—Ä–∏–º–µ—Ä—ã –≤—ã–ø–∏—Å–æ–∫ –∏–∑ –ú–æ–¥—É–ª—å–±–∞–Ω–∫–∞/Statement.xlsx" \
  --entity DBZ \
  --owner "–ü–∏—Ä–æ–∂–∫–æ–≤–∞ –ù–∞—Ç–∞–ª—å—è –í–∏–∫—Ç–æ—Ä–æ–≤–Ω–∞" \
  --fb-creds "../FinanceBot/service_account.json" \
  --fb-sheets "1bFBHIB53h7TJBknJatJn_y__11jCIP45ZbGsatnb1G4" \
  --clusters clusters.json \
  --out pnl_DBZ.xlsx \
  --last-months 6
```

### 2. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (DBZ, –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤) ‚úÖ

```
FinanceBot: 183 paid expenses (7 entity-tagged DBZ, 176 shared)
–ï–¥–∏–Ω—ã–π –∂—É—Ä–Ω–∞–ª: 319 —Å—Ç—Ä–æ–∫ (136 –±–∞–Ω–∫ + 183 FinanceBot)
```

| –ü–µ—Ä–∏–æ–¥  | –î–æ—Ö–æ–¥—ã (–±–∞–Ω–∫) | –†–∞—Å—Ö–æ–¥—ã –±–∞–Ω–∫ | FB —Ä–∞—Å—Ö–æ–¥—ã   | –ü—Ä–∏–±—ã–ª—å      | –ú–∞—Ä–∂–∞ |
|---------|--------------|--------------|--------------|--------------|-------|
| 2025-08 | 3.5M         | 304k         | 0            | 3.15M        | 91.2% |
| 2025-11 | 26.9M        | 696k         | 0            | 26.2M        | 97.4% |
| 2025-12 | 23.6M        | 1.31M        | 0            | 22.3M        | 94.5% |
| 2026-01 | 8.79M        | 1.37M        | **884k**     | 6.54M        | 74.3% |
| 2026-02 | 7.28M        | 1.39M        | **7.67M**    | **‚àí1.78M**   | ‚àí24%  |

> **–ì–ª–∞–≤–Ω—ã–π –∏–Ω—Å–∞–π—Ç:** –±–∞–Ω–∫–æ–≤—Å–∫–∏–π P&L DBZ –∑–∞ —Ñ–µ–≤—Ä–∞–ª—å = +5.9M, –Ω–æ —Å —É—á—ë—Ç–æ–º FinanceBot (–∑–∞—Ä–ø–ª–∞—Ç—ã, USDT) = **‚àí1.78M**. –≠—Ç–æ —Ä–µ–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∞.

### 3. –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã / —á—Ç–æ –Ω–∞–¥–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å

#### A. 176/183 FinanceBot —Ä–∞—Å—Ö–æ–¥–æ–≤ ‚Äî "–æ–±—â–∏–µ" (–Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ DBZ)
–ü—Ä–∏—á–∏–Ω–∞: –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞—Ä–ø–ª–∞—Ç–Ω—ã—Ö –≤—ã–ø–ª–∞—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç "DBZ" / "–î–ë–ó" –≤ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏.

**–î–≤–∞ –ø—É—Ç–∏:**
1. **entity_patterns –≤ clusters.json** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –§–ò–û –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ª—é–¥–µ–π, –ø–æ–ª—É—á–∞—é—â–∏—Ö –∑–∞—Ä–ø–ª–∞—Ç—É –æ—Ç DBZ
2. **–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ "–Æ—Ä–ª–∏—Ü–æ" –≤ FinanceBot** ‚Äî –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏ –º–µ–Ω–µ–¥–∂–µ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç —é—Ä–ª–∏—Ü–æ

–ü—Ä–∏–º–µ—Ä –æ–±–æ–≥–∞—â–µ–Ω–∏—è patterns –≤ clusters.json:
```json
"entity_patterns": {
  "DBZ": ["–î–ë–ó", "DBZ", "–ü–ò–†–û–ñ–ö–û–í", "–ò–í–ê–ù–û–í –ò–í–ê–ù", "–°–ò–î–û–†–û–í–ê"]
}
```

#### B. –ê–Ω–æ–º–∞–ª–∏—è Jul 2026 (1 —Ä–∞—Å—Ö–æ–¥)
–í FinanceBot –µ—Å—Ç—å –∑–∞–ø–∏—Å—å —Å –¥–∞—Ç–æ–π –≤ –±—É–¥—É—â–µ–º (–∏—é–ª—å 2026). –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –æ—à–∏–±–∫–∞ –≤–≤–æ–¥–∞ –≥–æ–¥–∞.
–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Sheets –≤—Ä—É—á–Ω—É—é.

#### C. –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –Ω—É–ª–∏ (-0.00) –≤ –≤—ã–≤–æ–¥–µ
–ö–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥: –∫–æ–≥–¥–∞ FinanceBot —Ä–∞—Å—Ö–æ–¥–æ–≤ = 0 –∑–∞ –ø–µ—Ä–∏–æ–¥, –≤—ã–≤–æ–¥–∏—Ç—Å—è -0.00. –ù–µ—Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ.

---

## –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –°–ò–°–¢–ï–ú–´ (—Ç–µ–∫—É—â–∞—è)

```
–ò–°–¢–û–ß–ù–ò–ö–ò                    –û–ë–†–ê–ë–û–¢–ö–ê                  –û–¢–ß–Å–¢–´
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ú–æ–¥—É–ª—å–±–∞–Ω–∫ XLSX   ‚Üí  parser.py + classifier.py  ‚Üí‚îê
                                                   ‚îú‚Üí merge_pnl.py ‚Üí pnl_ENTITY.xlsx
FinanceBot Sheets ‚Üí  src/fb_adapter.py          ‚Üí‚îò     (4 –ª–∏—Å—Ç–∞: –ö–æ–º–ø–∞–Ω–∏—è / –Æ—Ä–ª–∏—Ü–æ /
                                                         –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ / –ñ—É—Ä–Ω–∞–ª)
clusters.json     ‚Üí  entity_patterns, fx_rates  ‚Üí‚îò

–ù–∞–ª–∏—á–Ω—ã–µ (manual) ‚Üí  [TODO: manual_entry.py]
–ö–∞—Ä—Ç—ã —Ñ–∏–∑–ª–∏—Ü–∞     ‚Üí  [TODO: card parsers]
Bybit             ‚Üí  [TODO: bybit_adapter.py]
```

### –õ–∏—Å—Ç—ã FinanceBot (fb_adapter —á–∏—Ç–∞–µ—Ç –≤—Å–µ 4):
| –õ–∏—Å—Ç                 | –í–∞–ª—é—Ç–∞  | –°—Ç–∞—Ç—É—Å    |
|----------------------|---------|-----------|
| –û—Å–Ω–æ–≤–Ω—ã–µ             | RUB/BYN/KZT | –û–ø–ª–∞—á–µ–Ω–∞ |
| –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–¥—ã  | RUB (–Ω–∞–ª–∏—á–Ω—ã–µ) | –§–∞–∫—Ç |
| USDT                 | USDT    | –û–ø–ª–∞—á–µ–Ω–∞  |
| CNY                  | CNY     | –û–ø–ª–∞—á–µ–Ω–∞  |

---

## –ù–ï–†–ï–®–Å–ù–ù–´–ï –í–û–ü–†–û–°–´

| # | –í–æ–ø—Ä–æ—Å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|--------|-----------|
| Q-A | –í—ã–ø–∏—Å–∫–∏ –∫–∞–∫–∏—Ö —é—Ä–ª–∏—Ü –µ—Å—Ç—å –¥–ª—è PnL? (—Ç–æ–ª—å–∫–æ DBZ?) | üî¥ |
| Q-B | –ù—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å—Ç–∞—Ä—ã—Ö –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –∂—É—Ä–Ω–∞–ª–æ–≤? | üü° |
| Q-C | –§–∏–Ω–æ—Ç—á—ë—Ç—ã WB/Ozon ‚Äî –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å/—Å—Ç—Ä—É–∫—Ç—É—Ä–∞? | üî¥ |
| Q-D | Google Sheets API credentials –¥–ª—è –∑–∞–ø–∏—Å–∏ –∂—É—Ä–Ω–∞–ª–∞ –∏–∑ —Å–∫—Ä–∏–ø—Ç–∞? | üü° |
| Q-E | 4 –∑–∞–ø–∏—Å–∏ "—Ç–æ–ª—å–∫–æ –≤ –∂—É—Ä–Ω–∞–ª–µ" –≤ diff ‚Äî —á—Ç–æ —ç—Ç–æ? FinanceBot? –î—Ä—É–≥–æ–π –±–∞–Ω–∫? | üü° |
| Q-F | +500k –æ—Ç –ë–ê–ù–ö –í–¢–ë (2026-01-16) ‚Äî —á—Ç–æ –∑–∞ –æ–ø–µ—Ä–∞—Ü–∏—è? | üü° |
| Q-G | –ö–∞–∫ –ø—Ä–∏–≤—è–∑–∞—Ç—å 176 shared FB —Ä–∞—Å—Ö–æ–¥–æ–≤ –∫ —é—Ä–ª–∏—Ü–∞–º? –§–ò–û —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤? | üî¥ |
| Q-H | Jul 2026 –∞–Ω–æ–º–∞–ª—å–Ω—ã–π —Ä–∞—Å—Ö–æ–¥ –≤ FinanceBot ‚Äî –∫–∞–∫–∞—è –∑–∞–ø–∏—Å—å? | üü° |

---

## –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò (–≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞)

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–ò—Ç–µ—Ä–∞—Ü–∏—è 2b)
1. –û—Ç–∫—Ä—ã—Ç—å `pnl_DBZ.xlsx` ‚Üí –ª–∏—Å—Ç "üîç –ö–∞—Ç–µ–≥–æ—Ä–∏–∏" ‚Üí –∏–∑—É—á–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É FinanceBot —Ä–∞—Å—Ö–æ–¥–æ–≤
2. –û–±–æ–≥–∞—Ç–∏—Ç—å `entity_patterns` –≤ clusters.json ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –§–ò–û –ª—é–¥–µ–π, –ø–æ–ª—É—á–∞—é—â–∏—Ö –æ—Ç DBZ
3. –ù–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å Jul 2026 –∑–∞–ø–∏—Å—å –≤ FinanceBot Sheets (–∞–Ω–æ–º–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞)

### –ò—Ç–µ—Ä–∞—Ü–∏—è 3 ‚Äî –ü–∞—Ç—á-—Ñ–∞–π–ª –¥–ª—è –∂—É—Ä–Ω–∞–ª–∞
4. –ò–∑ diff_DBZ.xlsx ‚Üí –ª–∏—Å—Ç "‚ùå –ù–µ—Ç –≤ –∂—É—Ä–Ω–∞–ª–µ" ‚Üí —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Excel-–ø–∞—Ç—á –≤ —Ñ–æ—Ä–º–∞—Ç–µ –∂—É—Ä–Ω–∞–ª–∞

### –ò—Ç–µ—Ä–∞—Ü–∏—è 4 ‚Äî –ü–æ–ª–Ω—ã–π P&L –ø–æ –≤—Å–µ–º —é—Ä–ª–∏—Ü–∞–º
5. –î–æ–±–∞–≤–∏—Ç—å –≤—ã–ø–∏—Å–∫–∏ MN, VAS –∏ –¥—Ä. ‚Üí –∑–∞–ø—É—Å—Ç–∏—Ç—å merge_pnl.py –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
6. –°–æ–∑–¥–∞—Ç—å `merge_all.py` ‚Äî –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –ø–æ –≤—Å–µ–º —é—Ä–ª–∏—Ü–∞–º —Å—Ä–∞–∑—É

### –§–∞–∑–∞ 3 ‚Äî –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
7. manual_entry.py ‚Äî –≤–≤–æ–¥ –Ω–∞–ª–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (CSV –∏–ª–∏ Excel)
8. –ü–∞—Ä—Å–µ—Ä—ã –∫–∞—Ä—Ç–æ—á–Ω—ã—Ö –≤—ã–ø–∏—Å–æ–∫ (–¢–∏–Ω—å–∫–æ—Ñ—Ñ, –ê–ª—å—Ñ–∞)
9. bybit_adapter.py ‚Äî –≤—ã–ø–∏—Å–∫–∏ —Å –±–∏—Ä–∂–∏

---

## –ö–û–ù–¢–ï–ö–°–¢ –ü–û –Æ–†–õ–ò–¶–ê–ú

| –Æ—Ä–ª–∏—Ü–æ | –§–∏–∑–ª–∏—Ü–æ | WB | Ozon |
|--------|---------|----|----- |
| DBZ    | –ù–∞—Ç–∞—à–∞ (–ü–∏—Ä–æ–∂–∫–æ–≤–∞) | ‚úÖ | ‚Äî |
| MN     | –î–µ–Ω–∏—Å | ‚úÖ | ‚Äî |
| VAS    | –í–∞—Å—è | ‚úÖ | ‚úÖ |
| LYA    | –ò–ª—å—è | ‚úÖ | ‚úÖ |
| MAKS   | –ú–∞–∫—Å–∏–º | ‚úÖ | ‚Äî |
| LIFE   | –û–û–û –®–æ–ø–ø–∏–ª–∞–π—Ñ | ‚úÖ | ‚úÖ |
| HUB    | ShopHub | ‚úÖ | ‚úÖ |
| ALEX   | –ê–ª–µ–∫—Å–∞–Ω–¥—Ä | ‚úÖ | ‚úÖ |

**–ö–ª–∞—Å—Ç–µ—Ä—ã (–≤ clusters.json):**
- `WB_NORZ` = DBZ + MN
- `WB_FULL` = VAS + LYA + MAKS
- `SHOPLIFE` = LIFE + HUB + ALEX

---

## –°–°–´–õ–ö–ò –ù–ê –ö–õ–Æ–ß–ï–í–´–ï –§–ê–ô–õ–´

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-----------|
| `src/parser.py` | –ü–∞—Ä—Å–µ—Ä XLSX (–ú–æ–¥—É–ª—å–±–∞–Ω–∫) |
| `src/classifier.py` | –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –±–∞–Ω–∫–∞ |
| `src/fb_adapter.py` | –ê–¥–∞–ø—Ç–µ—Ä FinanceBot Sheets ‚Üí unified DataFrame |
| `import_statement.py` | –ü–∞—Ä—Å–∏–Ω–≥ –≤—ã–ø–∏—Å–∫–∏ ‚Üí Excel (4 –ª–∏—Å—Ç–∞) |
| `diff_journal.py` | –°–≤–µ—Ä–∫–∞ —Å –∂—É—Ä–Ω–∞–ª–æ–º ‚Üí diff-–æ—Ç—á—ë—Ç |
| `merge_pnl.py` | –°–≤–æ–¥–Ω—ã–π P&L: –±–∞–Ω–∫ + FinanceBot ‚Üí Excel |
| `clusters.json` | –ö–æ–Ω—Ñ–∏–≥ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, entity_patterns, fx_rates |
| `output_DBZ.xlsx` | –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ DBZ (321 –æ–ø.) |
| `diff_DBZ.xlsx` | –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–≤–µ—Ä–∫–∏ DBZ (90% –ø–æ–∫—Ä—ã—Ç–∏–µ) |
| `pnl_DBZ.xlsx` | –°–≤–æ–¥–Ω—ã–π P&L DBZ (–±–∞–Ω–∫ + FinanceBot) |

---

## –ö–ê–ö –ü–†–û–î–û–õ–ñ–ò–¢–¨ –í –ù–û–í–û–ú –ß–ê–¢–ï

–°–∫–∞–∂–∏:
> "–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É. –ü—Ä–æ—á–∏—Ç–∞–π HANDOFF.md"

–§–∞–π–ª: `@Projects/BusinessBank/HANDOFF.md`
